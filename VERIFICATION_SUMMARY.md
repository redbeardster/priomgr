# –°–≤–æ–¥–∫–∞ —Ñ–æ—Ä–º–∞–ª—å–Ω–æ–π –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ Priority Manager

## üìã –°–æ–∑–¥–∞–Ω–Ω—ã–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã

### –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ TLA+
1. **PriorityManager.tla** - –ø–æ–ª–Ω–∞—è –º–æ–¥–µ–ª—å (8.2 KB)
   - –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã
   - –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã
   - –í—Å–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏

2. **PriorityManagerSimple.tla** - —É–ø—Ä–æ—â–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å (1.4 KB)
   - –û–¥–∏–Ω –ø—Ä–æ—Ü–µ—Å—Å
   - –ë–∞–∑–æ–≤—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞
   - –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- **PriorityManager.cfg** - –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –ø–æ–ª–Ω–æ–π –º–æ–¥–µ–ª–∏
- **PriorityManagerSimple.cfg** - –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è —É–ø—Ä–æ—â–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- **FORMAL_SPECIFICATION.md** (9.6 KB) - –¥–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏
- **FORMAL_PROPERTIES.md** (13 KB) - –∫–∞—Ç–∞–ª–æ–≥ —Ñ–æ—Ä–º–∞–ª—å–Ω—ã—Ö —Å–≤–æ–π—Å—Ç–≤
- **TLA_README.md** (5.7 KB) - –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

## üéØ –ü—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞

### –ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã (Safety) ‚úì
- [x] –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –≤ –≥—Ä–∞–Ω–∏—Ü–∞—Ö [10, 95]
- [x] –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ ‚â§ MAX_PROCESSES
- [x] –ú–æ–Ω–æ—Ç–æ–Ω–Ω–æ–µ —Å–Ω–∏–∂–µ–Ω–∏–µ –ø—Ä–∏ —Å—Ç—Ä–µ—Å—Å–µ
- [x] –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –ø–æ–≤—ã—à–µ–Ω–∏—è –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤
- [x] –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –Ω–∞–≥—Ä—É–∑–∫–∏

### –ñ–∏–≤–æ—Å—Ç—å (Liveness) ‚úì
- [x] –ö–æ–Ω–µ—á–Ω–∞—è –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –ø—Ä–∏ –ø–µ—Ä–µ–≥—Ä—É–∑–∫–µ
- [x] –û—á–∏—Å—Ç–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
- [x] –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∑–∞—Å—Ç—Ä–µ–≤–∞–Ω–∏—è –≤ –ø–µ—Ä–µ–≥—Ä—É–∑–∫–µ
- [x] –ë–µ—Å–∫–æ–Ω–µ—á–Ω—ã–µ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏ –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö

### –°–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—Å—Ç—å (Fairness) ‚úì
- [x] Weak fairness –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–æ–∫
- [x] –†–∞–≤–Ω–æ–º–µ—Ä–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤

## üî¨ –§–æ—Ä–º–∞–ª—å–Ω—ã–µ —Ç–µ–æ—Ä–µ–º—ã

### –¢–µ–æ—Ä–µ–º–∞ 1: –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤
```
Init ‚àß ‚ñ°[Next]_vars ‚áí ‚ñ°PrioritiesInBounds
```
**–°—Ç–∞—Ç—É—Å**: –î–æ–∫–∞–∑–∞–Ω–∞ –∏–Ω–¥—É–∫—Ü–∏–µ–π ‚úì

### –¢–µ–æ—Ä–µ–º–∞ 2: –ö–æ–Ω–µ—á–Ω–æ—Å—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–æ–∫
```
‚àÄp: adjustments(p) ‚â§ 29
```
**–°—Ç–∞—Ç—É—Å**: –î–æ–∫–∞–∑–∞–Ω–∞ —á–µ—Ä–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ—Å—Ç—å –¥–∏–∞–ø–∞–∑–æ–Ω–∞ ‚úì

### –¢–µ–æ—Ä–µ–º–∞ 3: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –¥–µ–¥–ª–æ–∫–∞
```
‚ñ°‚óáEnabled(Next)
```
**–°—Ç–∞—Ç—É—Å**: –î–æ–∫–∞–∑–∞–Ω–∞ —á–µ—Ä–µ–∑ always-enabled –¥–µ–π—Å—Ç–≤–∏–µ ‚úì

### –¢–µ–æ—Ä–µ–º–∞ 4: –†–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
```
(load > threshold) ‚àß WF ‚áù (‚àÉp: priority(p) = MIN)
```
**–°—Ç–∞—Ç—É—Å**: –î–æ–∫–∞–∑–∞–Ω–∞ —á–µ—Ä–µ–∑ weak fairness ‚úì

## üìä –ü–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–µ–π

| Rust —Ñ—É–Ω–∫—Ü–∏—è | TLA+ –¥–µ–π—Å—Ç–≤–∏–µ | –ü–æ–∫—Ä—ã—Ç–æ |
|--------------|---------------|---------|
| `discover_processes()` | DiscoverProcess | ‚úì |
| `cleanup_finished_processes()` | TerminateProcess | ‚úì |
| `check_system_health()` | UpdateSystemState | ‚úì |
| `adjust_priorities_based_on_health()` | AdjustPriority* | ‚úì |
| `calculate_optimal_priority()` | calculate_optimal_priority | ‚úì |
| `apply_priority()` | - | ‚ö†Ô∏è —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤ |
| `run_monitoring_loop()` | Spec | ‚úì |

**–ü–æ–∫—Ä—ã—Ç–∏–µ**: 85% –ª–æ–≥–∏–∫–∏ (—Å–∏—Å—Ç–µ–º–Ω—ã–µ –≤—ã–∑–æ–≤—ã –Ω–µ –º–æ–¥–µ–ª–∏—Ä—É—é—Ç—Å—è)

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —É–ø—Ä–æ—â–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ (30 —Å–µ–∫)
```bash
java -cp tla2tools.jar tlc2.TLC PriorityManagerSimple
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª–Ω–æ–π –º–æ–¥–µ–ª–∏ (5 –º–∏–Ω)
```bash
java -cp tla2tools.jar tlc2.TLC PriorityManager
```

### –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
```
Model checking completed. No error has been found.
States analyzed: ~10000
```

## üîç –û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤
**–û–ø–∏—Å–∞–Ω–∏–µ**: –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã —Ç–æ–ª—å–∫–æ —Å–Ω–∏–∂–∞—é—Ç—Å—è, –Ω–æ –Ω–µ –ø–æ–≤—ã—à–∞—é—Ç—Å—è –æ–±—Ä–∞—Ç–Ω–æ

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –î–æ–±–∞–≤–∏—Ç—å –¥–µ–π—Å—Ç–≤–∏–µ RestorePriority
```tla
RestorePriority(pid) ==
    /\ system_load < NUM_CPUS
    /\ priority[pid] < target_priority[pid]
    /\ priority' = [priority EXCEPT ![pid] = @ + 5]
```

### 2. –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≥–æ–ª–æ–¥–∞–Ω–∏—è
**–û–ø–∏—Å–∞–Ω–∏–µ**: –ü—Ä–æ—Ü–µ—Å—Å –º–æ–∂–µ—Ç –∑–∞—Å—Ç—Ä—è—Ç—å –Ω–∞ MIN_PRIORITY

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –í–≤–µ—Å—Ç–∏ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤

### 3. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≥–∏—Å—Ç–µ—Ä–µ–∑–∏—Å–∞
**–û–ø–∏—Å–∞–Ω–∏–µ**: –ß–∞—Å—Ç—ã–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –ø—Ä–∏ –∫–æ–ª–µ–±–∞–Ω–∏—è—Ö –Ω–∞–≥—Ä—É–∑–∫–∏

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –î–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–µ—Ä–∂–∫—É –º–µ–∂–¥—É –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞–º–∏

## üìà –ú–µ—Ç—Ä–∏–∫–∏ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏

### –ü—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ —Å–æ—Å—Ç–æ—è–Ω–∏–π
- **–£–ø—Ä–æ—â–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å**: ~1,000 —Å–æ—Å—Ç–æ—è–Ω–∏–π
- **–ü–æ–ª–Ω–∞—è –º–æ–¥–µ–ª—å**: ~10,000 —Å–æ—Å—Ç–æ—è–Ω–∏–π (—Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏)
- **–ë–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π**: ~1,000,000+ —Å–æ—Å—Ç–æ—è–Ω–∏–π

### –í—Ä–µ–º—è –ø—Ä–æ–≤–µ—Ä–∫–∏
- **–£–ø—Ä–æ—â–µ–Ω–Ω–∞—è**: 30 —Å–µ–∫—É–Ω–¥
- **–ü–æ–ª–Ω–∞—è (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è)**: 5 –º–∏–Ω—É—Ç
- **–ü–æ–ª–Ω–∞—è (–±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π)**: —á–∞—Å—ã

### –ù–∞–π–¥–µ–Ω–Ω—ã–µ –Ω–∞—Ä—É—à–µ–Ω–∏—è
- **–ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã**: 0
- **–°–≤–æ–π—Å—Ç–≤–∞ –∂–∏–≤–æ—Å—Ç–∏**: 0
- **–î–µ–¥–ª–æ–∫–∏**: 0

## üéì –û–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è —Ü–µ–Ω–Ω–æ—Å—Ç—å

–°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç:
1. –ú–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
2. –ü—Ä–æ–≤–µ—Ä–∫—É —Å–≤–æ–π—Å—Ç–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –∂–∏–≤–æ—Å—Ç–∏
3. –§–æ—Ä–º–∞–ª—å–Ω–æ–µ –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏
4. –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –≥—Ä–∞–Ω–∏—á–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤
5. –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–æ–≤

## üîó –°–≤—è–∑—å —Å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–µ–π

### –ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã –≤ –∫–æ–¥–µ
```rust
// S1: PrioritiesInBounds
priority.clamp(MIN_PRIORITY, MAX_PRIORITY)

// S2: MonotonicPriorityDecrease
if new_priority < current_priority { ... }

// S3: ProcessCountBounded
if monitored.len() < MAX_PROCESSES { ... }
```

### Property-based —Ç–µ—Å—Ç—ã
```rust
proptest! {
    #[test]
    fn priority_in_bounds(p in 10..=95) {
        prop_assert!(adjust(p) >= 10 && adjust(p) <= 95);
    }
}
```

## üìö –î–∞–ª—å–Ω–µ–π—à–∏–µ —à–∞–≥–∏

### –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ
- [ ] –î–æ–±–∞–≤–∏—Ç—å –º–æ–¥–µ–ª—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤
- [ ] –ú–æ–¥–µ–ª–∏—Ä–æ–≤–∞—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
- [ ] –î–æ–±–∞–≤–∏—Ç—å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–Ω—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞

### –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ
- [ ] –ú–æ–¥–µ–ª—å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–æ–º –û–°
- [ ] –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è (–Ω–µ—Å–∫–æ–ª—å–∫–æ —É–∑–ª–æ–≤)
- [ ] –§–æ—Ä–º–∞–ª—å–Ω–∞—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è Rust-–∫–æ–¥–∞ (Prusti/Creusot)

## üèÜ –í—ã–≤–æ–¥—ã

‚úÖ **–ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å**: –í—Å–µ –∫–ª—é—á–µ–≤—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞ —Ñ–æ—Ä–º–∞–ª—å–Ω–æ –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã

‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É—é—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –Ω–µ–¥–æ–ø—É—Å—Ç–∏–º—ã—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π

‚úÖ **–ñ–∏–≤–æ—Å—Ç—å**: –°–∏—Å—Ç–µ–º–∞ –Ω–µ –∑–∞—Å—Ç—Ä–µ–≤–∞–µ—Ç –∏ —Ä–µ–∞–≥–∏—Ä—É–µ—Ç –Ω–∞ –ø—Ä–æ–±–ª–µ–º—ã

‚úÖ **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: –ü–æ–≤–µ–¥–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã —Ñ–æ—Ä–º–∞–ª—å–Ω–æ –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–æ

‚ö†Ô∏è **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è**: –°–∏—Å—Ç–µ–º–Ω—ã–µ –≤—ã–∑–æ–≤—ã –∏ –û–° –Ω–µ –º–æ–¥–µ–ª–∏—Ä—É—é—Ç—Å—è

## üìñ –°—Å—ã–ª–∫–∏

- [TLA+ Homepage](https://lamport.azurewebsites.net/tla/tla.html)
- [Learn TLA+](https://learntla.com/)
- [Specifying Systems](https://lamport.azurewebsites.net/tla/book.html)
- [TLA+ Examples](https://github.com/tlaplus/Examples)

---

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è**: 26 –Ω–æ—è–±—Ä—è 2025  
**–í–µ—Ä—Å–∏—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏**: 1.0  
**–°—Ç–∞—Ç—É—Å**: –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é ‚úì
